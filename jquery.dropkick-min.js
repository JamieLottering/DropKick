/**
 * DropKick 1.2
 *
 * Highly customizable <select> lists
 * https://github.com/robdel12/DropKick
 *
 * 2011 Jamie Lottering <http://github.com/JamieLottering>
 *                        <http://twitter.com/JamieLottering>
 *
*/(function(t,n,r){"use strict";var i=navigator.userAgent.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/),s=!!i,o=s&&parseFloat(i[1])<7,u={},a=[],f={left:37,up:38,right:39,down:40,enter:13,tab:9,zero:48,z:90,last:221},l=['<div class="dk_container" id="dk_container_{{ id }}" tabindex="{{ tabindex }}">','   <a class="dk_toggle">','   <span class="dk_label">{{ label }}</span>'," </a>",' <div class="dk_options">','   <ul class="dk_options_inner">',"   </ul>"," </div>","</div>"].join(""),c='<li class="{{ current }} {{ disabled }}"><a data-dk-dropdown-value="{{ value }}">{{ text }}</a></li>',h={startSpeed:400,theme:!1,change:!1,syncReverse:!0},p=null,d=null,v=function(e,t,n,r){var i,s,o,u;i=e.attr("data-dk-dropdown-value");s=e.text();o=t.data("dropkick");u=o.$select;u.val(i).trigger("change");t.find(".dk_label").text(s);n=n||!1;o.settings.change&&!n&&!o.settings.syncReverse&&o.settings.change.call(u,i,s)},m=function(e){e.removeClass("dk_open");p=null},g=function(e){var r=e.find(".dk_toggle"),i=e.find(".dk_options").outerHeight(),s=t(n).height()-r.outerHeight()-r.offset().top+t(n).scrollTop(),o=r.offset().top-t(n).scrollTop();return i<o?i<s:!0},y=function(e,t){var n=e.data("dropkick"),r=g(e);e.find(".dk_options").css({top:r?e.find(".dk_toggle").outerHeight()-1:"",bottom:r?"":e.find(".dk_toggle").outerHeight()-1});e.toggleClass("dk_open");b(e,e.find(".dk_option_current"),t);p=e},b=function(e,t,n){var r=e.find(".dk_options_inner"),i=t.prevAll("li").outerHeight()*t.prevAll("li").length,s=r.scrollTop(),o=r.height()+r.scrollTop()-t.outerHeight();(n&&n.type==="keydown"||i<s||i>o)&&r.scrollTop(i)},w=function(e,t,n){t.find(".dk_option_current").removeClass("dk_option_current");e.addClass("dk_option_current");b(t,e,n)},E=function(e,n){var r=e.keyCode,i=n.data("dropkick"),s=String.fromCharCode(r),o=n.find(".dk_options"),u=n.hasClass("dk_open"),a=o.find("li"),l=n.find(".dk_option_current"),c=a.first(),h=a.last(),p,d,g,b,E,S,x;switch(r){case f.enter:if(u){if(!l.hasClass("disabled")){v(l.find("a"),n);m(n)}}else y(n,e);e.preventDefault();break;case f.tab:if(u){v(l.find("a"),n);m(n)}break;case f.up:d=l.prev("li");u?d.length?w(d,n,e):w(h,n,e):y(n,e);e.preventDefault();break;case f.down:if(u){p=l.next("li").first();p.length?w(p,n,e):w(c,n,e)}else y(n,e);e.preventDefault();break;default:}if(r>=f.zero&&r<=f.z){g=(new Date).getTime();if(i.finder===null){i.finder=s.toUpperCase();i.timer=g}else if(g>parseInt(i.timer,10)+1e3){i.finder=s.toUpperCase();i.timer=g}else{i.finder=i.finder+s.toUpperCase();i.timer=g}b=a.find("a");for(E=0,S=b.length;E<S;E++){x=t(b[E]);if(x.html().toUpperCase().indexOf(i.finder)===0){v(x,n);w(x.parent(),n,e);break}}n.data("dropkick",i)}},S=function(e){return t.trim(e).length>0?e:!1},x=function(e,n){var r=e,i=[],s,o,u,a,f,l,h;r=r.replace("{{ id }}",n.id);r=r.replace("{{ label }}",n.label);r=r.replace("{{ tabindex }}",n.tabindex);if(n.options&&n.options.length)for(o=0,u=n.options.length;o<u;o++){a=t(n.options[o]);f="dk_option_current";l=" disabled";h=c;h=h.replace("{{ value }}",a.val());h=h.replace("{{ current }}",S(a.val())===n.value?f:"");h=h.replace("{{ disabled }}",a.attr("disabled")!==undefined?l:"");h=h.replace("{{ text }}",a.text());i[i.length]=h}s=t(r);s.find(".dk_options_inner").html(i.join(""));return s};o||(r.documentElement.className=r.documentElement.className+" dk_fouc");u.init=function(e){e=t.extend({},h,e);return this.each(function(){var n=t(this),r=n.find(":selected").first(),i=n.find("option"),s=n.data("dropkick")||{},o=n.attr("id")||n.attr("name"),u=e.width||n.outerWidth(),f=n.attr("tabindex")||"0",c=!1,h;if(navigator.userAgent.match(/iPad|iPhone|Android|IEMobile|BlackBerry/i)){t(".dk_fouc select").css("top","0");return!1}if(s.id)return n;s.settings=e;s.tabindex=f;s.id=o;s.$original=r;s.$select=n;s.value=S(n.val())||S(r.attr("value"));s.label=r.text();s.options=i;c=x(l,s);c.find(".dk_toggle").css({width:u+"px"});n.before(c);c=t('div[id="dk_container_'+o+'"]').fadeIn(e.startSpeed);h=e.theme||"default";c.addClass("dk_theme_"+h);s.theme=h;s.$dk=c;n.data("dropkick",s);c.addClass(n.attr("class"));c.data("dropkick",s);a[a.length]=n;c.bind("focus.dropkick",function(){d=c.addClass("dk_focus")}).bind("blur.dropkick",function(){c.removeClass("dk_focus");d=null});s.settings.syncReverse&&n.bind("change",function(e){var r=n.val(),i=t('a[data-dk-dropdown-value="'+r+'"]',c),o=i.text();c.find(".dk_label").text(o);s.settings.change&&s.settings.change.call(n,r,o);w(i.parent(),c,e)})})};u.theme=function(e){var n=t(this),r=n.data("dropkick"),i=r.$dk,s="dk_theme_"+r.theme;i.removeClass(s).addClass("dk_theme_"+e);r.theme=e};u.reset=function(){var t,n,r,i,s;for(t=0,n=a.length;t<n;t++){r=a[t].data("dropkick");i=r.$dk;s=i.find("li").first();i.find(".dk_label").text(r.label);i.find(".dk_options_inner").animate({scrollTop:0},0);w(s,i,e);v(s,i,!0)}};u.reload=function(){var e=t(this),n=e.data("dropkick");e.removeData("dropkick");t("#dk_container_"+n.id).remove();e.dropkick(n.settings)};u.setValue=function(e){var n=t(this).data("dropkick").$dk,r=n.find('.dk_options a[data-dk-dropdown-value="'+e+'"]');v(r,n);w(r.parent(),n)};u.refresh=function(){return this.each(function(){var e=t(this),n=e.data("dropkick");e.removeData("dropkick");t("#dk_container_"+n.id).remove();e.dropkick(n.settings)})};t.fn.dropkick=function(e){if(!o){if(u[e])return u[e].apply(this,Array.prototype.slice.call(arguments,1));if(typeof e=="object"||!e)return u.init.apply(this,arguments)}};t(function(){t(r).on(s?"mousedown":"click",".dk_options a",function(e){var n=t(this),r=n.parents(".dk_container").first();if(!n.parent().hasClass("disabled")){v(n,r);w(n.parent(),r);m(r)}e.preventDefault();return!1});t(r).bind("keydown.dk_nav",function(e){var t=null;p?t=p:d&&!p&&(t=d);t&&E(e,t)});t(r).on("click",null,function(e){if(p&&t(e.target).closest(".dk_container").length==0)m(p);else if(t(e.target).is(".dk_toggle, .dk_label")){var r=t(e.target).parents(".dk_container").first();if(r.hasClass("dk_open"))m(r);else{p&&m(p);y(r,e)}if(n.ontouchstart!==undefined){r.addClass("dk_touch");r.find(".dk_options_inner").addClass("scrollable vertical")}return!1}});var e,i="onwheel"in n?"wheel":"onmousewheel"in r?"mousewheel":"MouseScrollEvent"in n?"DOMMouseScroll MozMousePixelScroll":!1;i&&t(r).on(i,".dk_options_inner",function(e){var t=e.originalEvent.wheelDelta||-e.originalEvent.deltaY||-e.originalEvent.detail;if(s){this.scrollTop-=Math.round(t/10);return!1}return t>0&&this.scrollTop<=0||t<0&&this.scrollTop>=this.scrollHeight-this.offsetHeight?!1:!0})})})(jQuery,window,document);